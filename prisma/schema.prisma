generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"] // Use this instead of adapter-neon
}

datasource db {
  provider = "postgresql"

}

model Member {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  phone     String?
  createdAt DateTime @default(now())
  loans     Loan[]
}

model Loan {
  id        Int      @id @default(autoincrement())
  memberId  Int
  amount    Float
  duration  Int
  interest  Float
  createdAt DateTime @default(now())

  member    Member     @relation(fields: [memberId], references: [id])
  interests Interest[]
}

model Interest {
  id        Int      @id @default(autoincrement())
  loanId    Int
  rate      Float
  createdAt DateTime @default(now())

  loan Loan @relation(fields: [loanId], references: [id])
}

model LoanApplication {
  id          String   @id @default(cuid())
  // Personal Info
  title       String
  surname     String
  firstName   String
  middleName  String?
  dateOfBirth String
  gender      String
  nationality String

  // Contact Info
  residentialAddress String
  contactAddress     String
  tin                String
  email              String
  mobilePhone        String

  // Loan Info
  loanAmount    String
  requestDate   String
  duration      String
  interest      String
  repaymentDate String

  // Spouse Info (Fixed capitalization from 'string' to 'String')
  spouseName               String
  spouseMobilePhone        String
  spouseTitle              String
  spouseDOB                String
  spouseGender             String
  spouseNationality        String
  spouseStateOfOrigin      String
  spouseLocalGovt          String
  spouseMaritalStatus      String
  spouseResidentialAddress String

  // Bank Info
  bankName      String
  accountNumber String
  accountName   String
  accountType   String

  // Status & Metadata
  status    String   @default("Pending")
  createdAt DateTime @default(now())

  // Relationship
  member   Membership @relation(fields: [memberId], references: [id])
  memberId String
}

model Membership {
  id                 String   @id @default(cuid())
  // Personal Details
  title              String
  surname            String
  firstName          String
  middleName         String?
  dateOfBirth        String
  gender             String
  nationality        String

  // Contact & ID
  residentialAddress String
  contactAddress     String
  tin                String // Tax Identification Number
  email              String @unique
  mobilePhone        String

  // Banking
  bankName      String
  accountType   String
  accountName   String
  accountNumber String

  // Spouse Info
  spouseName   String?
  spouseMobile String?

  // System Fields
  status           String            @default("Active")
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
  loanApplications LoanApplication[]
}